-- Generated by utils/generate_premake.py
-- Lambda Build System Premake5 Configuration
-- DO NOT EDIT MANUALLY - Regenerate using: python3 utils/generate_premake.py

workspace "Lambda"
    configurations { "Debug", "Release" }
    platforms { "x64", "Linux_x64" }
    location "build/premake"
    startproject "lambda-linux"
    toolset "gcc"
    
    -- Global settings
    cppdialect "C++17"
    cdialect "C99"
    warnings "Extra"
    
    filter "configurations:Debug"
        defines { "DEBUG" }
        symbols "On"
        optimize "Off"
    
    -- AddressSanitizer for non-Linux platforms only (conflicts with -static)
    filter { "configurations:Debug", "not platforms:Linux_x64" }
        buildoptions { "-fsanitize=address", "-fno-omit-frame-pointer" }
        linkoptions { "-fsanitize=address" }
    
    filter "configurations:Release"
        defines { "NDEBUG" }
        optimize "On"
    
    -- Linux cross-compilation settings
    filter "platforms:Linux_x64"
        system "linux"
        architecture "x64"
        toolset "gcc"
        gccprefix "x86_64-linux-gnu-"
        defines { "LINUX", "_GNU_SOURCE", "NATIVE_LINUX_BUILD" }
        buildoptions { "-static", "-O2", "-g", "-pedantic", "-fno-omit-frame-pointer" }
        linkoptions { "-static" }
        libdirs { "linux-deps/lib" }
    
    filter {}

project "lambda-linux"
    kind "ConsoleApp"
    language "C++"
    targetdir "."
    objdir "build/obj/%{prj.name}"
    targetname "lambda-linux"
    targetextension ".exe"
    
    files {
        "lambda/tree-sitter-lambda/src/parser.c",
        "lambda/parse.c",
        "lib/strbuf.c",
        "lib/stringbuf.c",
        "lib/strview.c",
        "lib/arraylist.c",
        "lib/file.c",
        "lib/hashmap.c",
        "lib/log.c",
        "lib/mem-pool/src/variable.c",
        "lib/mem-pool/src/buffer.c",
        "lib/mem-pool/src/utils.c",
        "lib/url.c",
        "lib/url_parser.c",
        "lib/utf.c",
        "lib/num_stack.c",
        "lib/string.c",
        "lib/datetime.c",
        "lambda/lambda-data.cpp",
        "lambda/lambda-data-runtime.cpp",
        "lambda/runner.cpp",
        "lambda/transpile.cpp",
        "lambda/transpile-mir.cpp",
        "lambda/build_ast.cpp",
        "lambda/name_pool.cpp",
        "lambda/mir.c",
        "lambda/pack.cpp",
        "lambda/print.cpp",
        "lambda/lambda-eval.cpp",
        "lambda/lambda-eval-num.cpp",
        "lambda/lambda-proc.cpp",
        "lambda/utf_string.cpp",
        "lambda/lambda-mem.cpp",
        "lambda/validator.cpp",
        "lambda/validator/ast_validate.cpp",
        "lambda/validator/error_reporting.cpp",
        "lambda/input/css_tokenizer.c",
        "lambda/input/css_properties.c",
        "lambda/input/css_parser.c",
        "lambda/main-repl.cpp",
        "lambda/main.cpp",
        "lambda/input/mime-types.c",
        "lambda/input/css_tokenizer.c",
        "lambda/input/mime-detect.c",
        "lambda/input/css_parser.c",
        "lambda/input/css_properties.c",
        "lambda/input/input-jsx.cpp",
        "lambda/input/input-latex.cpp",
        "lambda/input/input_file_cache.cpp",
        "lambda/input/input-vcf.cpp",
        "lambda/input/input-man.cpp",
        "lambda/input/input.cpp",
        "lambda/input/input-ics.cpp",
        "lambda/input/input-json.cpp",
        "lambda/input/input-css.cpp",
        "lambda/input/input-pdf.cpp",
        "lambda/input/input_cache_util.cpp",
        "lambda/input/input_sysinfo.cpp",
        "lambda/input/input-math-ascii.cpp",
        "lambda/input/input-markup.cpp",
        "lambda/input/input-csv.cpp",
        "lambda/input/input_pool.cpp",
        "lambda/input/input-adoc.cpp",
        "lambda/input/input_http.cpp",
        "lambda/input/input-org.cpp",
        "lambda/input/input-mark.cpp",
        "lambda/input/input-toml.cpp",
        "lambda/input/input-mdx.cpp",
        "lambda/input/input_dir.cpp",
        "lambda/input/input-yaml.cpp",
        "lambda/input/input-html.cpp",
        "lambda/input/input-eml.cpp",
        "lambda/input/input-rtf.cpp",
        "lambda/input/input-math.cpp",
        "lambda/input/input-prop.cpp",
        "lambda/input/input-ini.cpp",
        "lambda/input/input-xml.cpp",
        "lambda/input/input-common.cpp",
        "lambda/format/format-md.cpp",
        "lambda/format/format-toml.cpp",
        "lambda/format/format-jsx.cpp",
        "lambda/format/format-text.cpp",
        "lambda/format/format.cpp",
        "lambda/format/format-prop.cpp",
        "lambda/format/format-math.cpp",
        "lambda/format/format-yaml.cpp",
        "lambda/format/format-css.cpp",
        "lambda/format/format-math-ascii.cpp",
        "lambda/format/format-html.cpp",
        "lambda/format/format-mdx.cpp",
        "lambda/format/format-rst.cpp",
        "lambda/format/format-org.cpp",
        "lambda/format/format-ini.cpp",
        "lambda/format/format-xml.cpp",
        "lambda/format/format-latex.cpp",
        "lambda/format/format-json.cpp",
        "lambda/format/format-wiki.cpp",
    }
    
    includedirs {
        ".",
        "lambda/tree-sitter/lib/include",
        "lambda/tree-sitter-lambda/bindings/c",
        "lib/mem-pool/include",
        "linux-deps/include",
        "linux-deps/include",
        "linux-deps/include",
        "linux-deps/include",
        "linux-deps/include",
        "linux-deps/include",
        "linux-deps/include/ncurses",
        "/usr/local/include",
        "/opt/homebrew/include",
    }
    
    libdirs {
        "/opt/homebrew/lib",
        "/usr/local/lib",
        "build/lib",
    }
    
    linkoptions {
        "../../linux-deps/lib/libtree-sitter.a",
        "../../linux-deps/lib/libmir.a",
        "../../linux-deps/lib/libcurl.a",
        "../../linux-deps/lib/libmpdec.a",
        "../../linux-deps/lib/libutf8proc.a",
        "../../linux-deps/lib/libedit.a",
        "../../linux-deps/lib/libncurses.a",
    }
    
    -- Linux cross-compilation static libraries
    filter "platforms:Linux_x64"
        linkoptions {
            "../../linux-deps/lib/libtree-sitter.a",
            "../../linux-deps/lib/libmir.a",
            "../../linux-deps/lib/libcurl.a",
            "../../linux-deps/lib/libmpdec.a",
            "../../linux-deps/lib/libutf8proc.a",
            "../../linux-deps/lib/libedit.a",
            "../../linux-deps/lib/libncurses.a",
        }
    
    filter {}
    
    buildoptions {
        "-fms-extensions",
        "-pedantic",
        "-fdiagnostics-color=auto",
    }
    
    -- C++ specific options
    filter "files:**.cpp"
        buildoptions { "-std=c++17" }
    
    -- C specific options
    filter "files:**.c"
        buildoptions { "-std=c99" }
    
    filter {}
    
    defines {
        "_GNU_SOURCE"
    }
    
