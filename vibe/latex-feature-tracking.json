{
  "module": "latex-typeset-pipeline",
  "description": "LaTeX to HTML conversion pipeline - parses LaTeX AST and converts to semantic HTML",
  "main_code_file": "lambda/tex/tex_document_model.cpp",
  "test_file": "test/test_latexml_compare_gtest.cpp",
  "test_suites": {
    "LatexJsBaseline": "54 tests - latex.js compatibility mode (legacy HTML output)",
    "LatexJsExtended": "Work-in-progress latex.js tests",
    "HybridBaseline": "51 tests - semantic HTML5 output mode",
    "HybridExtended": "Work-in-progress hybrid mode tests"
  },
  "features": [
    {
      "feature": "text-processing",
      "sub_features": [
        {
          "feature": "basic-text",
          "description": "Simple text in paragraphs, paragraph separation via double-newline",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs",
          "coding_note": "Handles paragraph splitting and text content accumulation",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "text/01_simple_text_in_paragraphs", "note": "Simple text paragraphs", "status": "passed"},
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "text/02_paragraphs_and_newlines", "note": "Paragraphs and newlines with \\\\, \\newline, \\par", "status": "passed"},
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "text/03_paragraphs_and_indentation", "note": "Paragraphs with \\noindent", "status": "passed"}
          ]
        },
        {
          "feature": "utf8-punctuation-symbols",
          "description": "UTF-8 characters, punctuation marks, German quotes, umlauts, thin spaces",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "transform_latex_text",
          "coding_note": "Transforms LaTeX text encoding to proper Unicode output",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "text/04_utf_8_text_punctuation_tex_symbols", "note": "UTF-8, punctuation, TeX symbols", "status": "passed"}
          ]
        },
        {
          "feature": "diacritics",
          "description": "Diacritic marks: \\', \\\", \\^, \\~, \\`, \\=, \\., \\u, \\v, \\H, \\c, \\d, \\b, \\t",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs, build_inline_content",
          "coding_note": "Handles combining diacritical marks and precomposed characters. Empty diacritics like \\^{} output char + ZWS",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "text/04_utf_8_text_punctuation_tex_symbols", "note": "Diacritics in context: Hôtel, naïve, élève, smørrebrød, Señorita, Schloß", "status": "passed"},
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "text/05_special_characters", "note": "Empty diacritics: \\^{}, \\~{}", "status": "passed"}
          ]
        },
        {
          "feature": "word-forming-commands",
          "description": "Word-forming commands: \\i, \\j, \\o, \\O, \\l, \\L, \\ss, \\ae, \\AE, \\oe, \\OE, \\aa, \\AA",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "is_word_forming_command, has_empty_curly_terminator",
          "coding_note": "Word-forming commands consume trailing space unless terminated with {}. \\ss{} outputs ß + ZWS",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "text/04_utf_8_text_punctuation_tex_symbols", "note": "\\o in smørrebrød, \\ss in Schloß/Straße", "status": "passed"},
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "text/05_special_characters", "note": "\\ss{} with ZWS marker", "status": "passed"}
          ]
        },
        {
          "feature": "special-characters",
          "description": "Escaped special characters: \\#, \\$, \\%, \\&, \\_, \\{, \\}, \\textbackslash",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_inline_content",
          "coding_note": "Maps LaTeX escape sequences to HTML entities or Unicode",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "text/05_special_characters", "note": "Special characters: # $ ^ & _ { } ~ \\ %", "status": "passed"}
          ]
        },
        {
          "feature": "ligatures",
          "description": "Typographic ligatures: ff→ﬀ, fi→ﬁ, fl→ﬂ, ffi→ﬃ, ffl→ﬄ, <<→«, >>→», !´→¡, ?´→¿",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "transform_latex_text, transform_text_ligatures",
          "coding_note": "Text ligatures applied during text transformation. Inverted punctuation ligatures in transform_text_ligatures",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "text/04_utf_8_text_punctuation_tex_symbols", "note": "Inverted punctuation: !´Señorita! → ¡Señorita!", "status": "passed"},
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "text/07_ligatures_and_ligature_prevention", "note": "ff, ffi, ffl, fi, fl ligatures and <<, >>", "status": "passed"}
          ]
        },
        {
          "feature": "dashes-dots",
          "description": "Dashes: - (hyphen), -- (en-dash), --- (em-dash). Dots: ... (ellipsis)",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "transform_latex_text",
          "coding_note": "Maps dash sequences to Unicode dash characters",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "text/06_dashes_dots_no_math", "note": "Dashes: daughter-in-law, pages 13–67, yes—or no?", "status": "passed"}
          ]
        },
        {
          "feature": "verbatim-text",
          "description": "Verbatim text: \\verb|...|, \\verb*|...|",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_inline_content",
          "coding_note": "Verbatim preserves literal text. Starred version shows spaces as ␣",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "text/08_verbatim_text", "note": "\\verb|verbatim|, \\verb/Any{thing/, \\verb*-spaces-", "status": "passed"}
          ]
        },
        {
          "feature": "tex-logos",
          "description": "TeX logos: \\TeX, \\LaTeX, \\LaTeXe",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_inline_content",
          "coding_note": "Generates styled span structure for logos",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "text/09_tex_and_latex_logos", "note": "\\TeX and \\LaTeX logos with proper styling", "status": "passed"}
          ]
        },
        {
          "feature": "alignment-commands",
          "description": "Text alignment: \\centering, \\raggedright, \\raggedleft",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs, apply_alignment_to_paragraph",
          "coding_note": "Alignment commands affect current and subsequent paragraphs until scope ends. Alignment markers track state, applied at paragraph finalization.",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "text/10_alignment", "note": "\\centering, \\raggedright, \\raggedleft paragraph alignment", "status": "passed"}
          ]
        }
      ]
    },
    {
      "feature": "formatting",
      "sub_features": [
        {
          "feature": "text-style-commands",
          "description": "Style commands: \\textbf, \\textit, \\texttt, \\textsc, \\textsf, \\textrm, \\emph",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_text_command, build_text_command_set_style",
          "coding_note": "Maps LaTeX font commands to HTML5 semantic elements (<strong>, <em>, <code>) in hybrid mode, CSS classes in legacy mode",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "formatting/01_basic_text_formatting", "note": "\\textbf, \\textit, \\texttt basic usage", "status": "passed"},
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "formatting/02_emphasis_command", "note": "\\emph emphasis", "status": "passed"},
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "formatting/03_nested_formatting", "note": "Nested formatting", "status": "passed"}
          ]
        },
        {
          "feature": "underline-strikethrough",
          "description": "Decorations: \\underline, \\sout (strikethrough)",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_text_command",
          "coding_note": "Maps to <u>, <s> in hybrid mode, CSS classes in legacy mode",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "formatting/04_underline_and_strikethrough", "note": "\\underline and \\sout", "status": "passed"}
          ]
        },
        {
          "feature": "font-size-commands",
          "description": "Size commands: \\tiny, \\small, \\normalsize, \\large, \\Large, \\LARGE, \\huge, \\Huge",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_text_command",
          "coding_note": "Maps to size CSS classes",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "formatting/05_font_size_commands", "note": "Font size commands", "status": "passed"}
          ]
        },
        {
          "feature": "alignment-environments",
          "description": "Alignment environments: center, flushleft, flushright",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_alignment_environment",
          "coding_note": "Creates div containers with alignment CSS classes",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "formatting/06_text_alignment", "note": "center, flushleft, flushright environments", "status": "passed"}
          ]
        }
      ]
    },
    {
      "feature": "symbols",
      "sub_features": [
        {
          "feature": "char-commands",
          "description": "Character by code: \\char98, \\char\"A0",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_inline_content",
          "coding_note": "Converts TeX char codes to Unicode",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "symbols/01_tex_char", "note": "\\char with decimal and hex values", "status": "passed"}
          ]
        },
        {
          "feature": "caret-notation",
          "description": "TeX caret notation: ^^A0, ^^^^2103",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_inline_content",
          "coding_note": "Parses ^^ and ^^^^ notation for Unicode codepoints",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "symbols/02_tex_and", "note": "^^78 (x), ^^^^2103 (℃)", "status": "passed"}
          ]
        },
        {
          "feature": "symbol-command",
          "description": "LaTeX symbol: \\symbol{\"00A9}",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_inline_content",
          "coding_note": "Converts \\symbol command to Unicode",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "symbols/03_latex_symbol", "note": "\\symbol{\"00A9} → ©", "status": "passed"}
          ]
        },
        {
          "feature": "predefined-symbols",
          "description": "Predefined symbols: \\textellipsis, \\textendash, \\textemdash, etc.",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_inline_content",
          "coding_note": "Maps common symbol commands to Unicode",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "symbols/04_predefined_symbols", "note": "\\textellipsis → …", "status": "passed"}
          ]
        }
      ]
    },
    {
      "feature": "sectioning",
      "sub_features": [
        {
          "feature": "chapter-section",
          "description": "Sectioning commands: \\chapter, \\section, \\subsection, etc.",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_section_command",
          "coding_note": "Generates h1-h6 elements with appropriate numbering. Legacy mode uses latex.js heading format, hybrid uses semantic headings.",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "sectioning/01_a_chapter", "note": "\\chapter with numbering", "status": "passed"},
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "sectioning/02_a_chapter_and_a_section", "note": "\\chapter and \\section together", "status": "passed"}
          ]
        },
        {
          "feature": "nested-sectioning",
          "description": "Section inside other elements (macros, groups)",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_section_command",
          "coding_note": "Sections inside macros need special handling for paragraph ending",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "sectioning/03_section_inside_a_macro_correct_visual_ap", "note": "\\section inside \\emph{}", "status": "passed"}
          ]
        }
      ]
    },
    {
      "feature": "environments",
      "sub_features": [
        {
          "feature": "nested-horizontal-envs",
          "description": "Nested horizontal environments like \\begin{empty}...\\end{empty}",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs",
          "coding_note": "Empty/horizontal environments insert ZWS markers at boundaries",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "environments/01_nested_horizontal_environments", "note": "Nested empty environments", "status": "passed"}
          ]
        },
        {
          "feature": "itemize-list",
          "description": "Unordered lists: \\begin{itemize} \\item ... \\end{itemize}",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_list_environment, build_list_item, process_list_content",
          "coding_note": "Creates ul elements with li items and bullet markers. Empty lists now render correctly. Hybrid mode uses class=\"itemize\", legacy uses class=\"list\"",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "environments/02_itemize_environment", "note": "itemize with paragraphs in items", "status": "passed"},
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "environments/03_empty_and_consecutive_itemize_environmen", "note": "Empty and consecutive itemize", "status": "passed"},
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "environments/04_nested_itemize_environments", "note": "Nested itemize", "status": "passed"},
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "environments/05_nested_itemize_environments_ii", "note": "Nested itemize (II)", "status": "passed"},
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "environments/06_single_itemize_environment_custom_labels", "note": "Custom item labels \\item[label]", "status": "passed"}
          ]
        },
        {
          "feature": "enumerate-list",
          "description": "Ordered lists: \\begin{enumerate} \\item ... \\end{enumerate}",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_list_environment, build_list_item",
          "coding_note": "Creates ol elements with numbered items. Custom labels via \\item[label] supported with font styling.",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "environments/07_enumerate_environment", "note": "enumerate with custom labels and font styling", "status": "passed"}
          ]
        },
        {
          "feature": "description-list",
          "description": "Description lists: \\begin{description} \\item[term] ... \\end{description}",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_list_environment, build_list_item",
          "coding_note": "Creates ul with bold term labels rendered via html_label field",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "environments/08_description_environment", "note": "description list with terms", "status": "passed"}
          ]
        },
        {
          "feature": "quote-environments",
          "description": "Block quotes: quote, quotation, verse environments",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_alignment_environment",
          "coding_note": "Uses ALIGNMENT element with env_name. Hybrid mode uses <blockquote>, legacy uses <div class='list quote/quotation/verse'>",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "environments/09_quote_quotation_verse", "note": "quote, quotation, verse environments", "status": "passed"}
          ]
        },
        {
          "feature": "font-environments",
          "description": "Font environments: small, bfseries, itshape, etc.",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_text_command",
          "coding_note": "Font environments apply to content within their scope",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "environments/10_font_environments", "note": "font environments (small, bfseries nesting)", "status": "passed"}
          ]
        },
        {
          "feature": "alignment-environments",
          "description": "Alignment environments: center, flushleft, flushright",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_alignment_environment",
          "coding_note": "Creates container with alignment class",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "environments/11_alignment", "note": "center, flushleft, flushright environments", "status": "passed"}
          ]
        },
        {
          "feature": "alignment-in-lists",
          "description": "Alignment environments containing lists, alignment commands in lists",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_alignment_environment, build_alignment_content, build_list_environment, process_list_content",
          "coding_note": "Nested lists inside center render correctly. \\centering inside itemize propagates to items and paragraphs via FLAG_CENTERED.",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "environments/12_alignment_of_lists", "note": "center with nested itemize, \\centering in items", "status": "passed"}
          ]
        },
        {
          "feature": "comment-environment",
          "description": "Comment environment: \\begin{comment}...\\end{comment}",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs",
          "coding_note": "Comment environment content should be completely discarded",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "environments/14_comment_environment", "note": "Comment environment removes content", "status": "passed"}
          ]
        },
        {
          "feature": "abstract-environment",
          "description": "Abstract environment: \\begin{abstract}...\\end{abstract}",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_blockquote_environment",
          "coding_note": "Creates abstract title and quotation-style body",
          "coding_status": "skipped",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "environments/13_abstract_and_fonts", "note": "abstract with font styles", "status": "skipped"}
          ]
        },
        {
          "feature": "table-environment",
          "description": "Tables: tabular, table environments",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_table_environment",
          "coding_note": "Creates HTML table structure from LaTeX tabular",
          "coding_status": "todo",
          "tests": []
        },
        {
          "feature": "figure-environment",
          "description": "Figures: figure environment with \\includegraphics, \\caption",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_figure_environment, build_image_command",
          "coding_note": "Creates figure/figcaption HTML structure",
          "coding_status": "todo",
          "tests": []
        },
        {
          "feature": "code-block-environment",
          "description": "Code blocks: verbatim, lstlisting environments",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_code_block_environment",
          "coding_note": "Preserves whitespace and literal text",
          "coding_status": "todo",
          "tests": []
        }
      ]
    },
    {
      "feature": "whitespace",
      "sub_features": [
        {
          "feature": "par-command",
          "description": "Paragraph separation via \\par command",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs",
          "coding_note": "\\par ends current paragraph and starts a new one.",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/01_whitespaces_are_compressed_comments_are_", "note": "\\par commands with whitespace compression", "status": "passed"}
          ]
        },
        {
          "feature": "forced-paragraphs",
          "description": "Force empty paragraphs with \\par~\\par",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs",
          "coding_note": "~ (non-breaking space) creates content to prevent empty paragraph elimination",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/02_how_to_force_two_paragraphs", "note": "\\par ~ \\par creates three paragraphs", "status": "passed"}
          ]
        },
        {
          "feature": "double-newline-paragraphs",
          "description": "Standard paragraph separation via double newline",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs",
          "coding_note": "Two or more consecutive newlines start new paragraph",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/03_standard_double_newline_paragraph_separa", "note": "Double newline paragraph separation", "status": "passed"}
          ]
        },
        {
          "feature": "linebreak-commands",
          "description": "Line breaks: \\\\, \\newline (should \\unskip)",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_inline_content",
          "coding_note": "\\\\ and \\newline create <br> and unskip trailing space",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/04_and_newline_do_not_add_spaces_they_unski", "note": "\\\\ and \\newline without extra spaces", "status": "passed"}
          ]
        },
        {
          "feature": "mbox-restricted-mode",
          "description": "\\mbox creates restricted horizontal mode (no line breaks)",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_text_command",
          "coding_note": "mbox creates hbox span, content is processed in restricted mode",
          "coding_status": "skipped",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/05_mbox_restricted_horizontal_mode_and_line", "note": "\\mbox with various content", "status": "skipped"}
          ]
        },
        {
          "feature": "unskip-ignorespaces",
          "description": "\\unskip removes preceding space, \\ignorespaces ignores following space",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs",
          "coding_note": "\\unskip breaks out of groups, \\ignorespaces does not",
          "coding_status": "skipped",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/06_unskip_breaks_out_of_groups_ignorespaces", "note": "\\unskip vs \\ignorespaces behavior", "status": "skipped"}
          ]
        },
        {
          "feature": "macro-space-after-args",
          "description": "Space added after macros that take arguments",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs",
          "coding_note": "Macros with arguments add boundary space after ]or }",
          "coding_status": "skipped",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/07_a_space_is_added_after_macros_that_take_", "note": "Space after \\macro[] and \\macro{}", "status": "skipped"}
          ]
        },
        {
          "feature": "space-hack-macros",
          "description": "Space-eating macros: \\pagebreak, \\label, etc.",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs",
          "coding_note": "Some macros should not leave spaces",
          "coding_status": "skipped",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/08_space_hack_to_prevent_multiple_spaces", "note": "\\pagebreak, \\label, etc. don't add spaces", "status": "skipped"}
          ]
        },
        {
          "feature": "newline-compression",
          "description": "More than two newlines equal two newlines",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs",
          "coding_note": "Multiple blank lines should not create multiple paragraphs",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/09_more_than_two_newlines_including_spaces_", "note": "Many newlines collapsed to paragraph break", "status": "passed"}
          ]
        },
        {
          "feature": "comment-paragraph-handling",
          "description": "Comments don't add or prevent paragraphs",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs",
          "coding_note": "Comments are discarded but shouldn't affect paragraph structure",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/10_comments_are_disregarded_and_won_t_add_a", "note": "Comments between paragraphs", "status": "passed"},
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/11_comments_are_disregarded_and_won_t_preve", "note": "Comments don't prevent paragraphs", "status": "passed"}
          ]
        },
        {
          "feature": "comment-line-joining",
          "description": "Comments at end of line join lines (remove linebreak)",
          "code_file": "lambda/input/input-latex-ts.cpp",
          "code_function": "should_skip_comment_and_space",
          "coding_note": "% at end of line removes the newline, joining with next line.",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/12_comments_can_remove_a_linebreak_i_e_spac", "note": "Supercal%ifragilist%icexpialidocious", "status": "passed"}
          ]
        },
        {
          "feature": "curly-group-spaces",
          "description": "Space handling inside and after curly groups",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_doc_element (curly_group handler), build_inline_content",
          "coding_note": "Groups {text} insert ZWSP at boundaries: at start if leading whitespace, always at end for content groups to mark } boundary",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/13_one_space_inside_as_well_as_after_a_grou", "note": "Curly group space handling", "status": "passed"}
          ]
        },
        {
          "feature": "macro-space-consumption",
          "description": "Macros without arguments ignore trailing spaces",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs, is_word_forming_command",
          "coding_note": "\\empty followed by spaces ignores them. \\empty{} forces a space (ZWS)",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/14_macros_without_arguments_ignore_spaces_a", "note": "\\empty consumes trailing space", "status": "passed"},
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/15_force_a_space_after_a_macro_with", "note": "\\empty{} forces ZWS", "status": "passed"},
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/16_force_a_space_after_a_macro_with", "note": "\\empty\\ forces ZWS", "status": "passed"}
          ]
        },
        {
          "feature": "escaped-space-variants",
          "description": "Escaped space: \\ followed by tab, space, or newline",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs",
          "coding_note": "\\ followed by whitespace creates a space (ZWS)",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/17_followed_by_tab_or_linebreak_is_also_a_s", "note": "\\<tab>, \\<newline> as spaces", "status": "passed"}
          ]
        },
        {
          "feature": "escaped-newline-edge-cases",
          "description": "Escaped newlines in empty/edge positions",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs",
          "coding_note": "Escaped newlines at document start/end, paragraph start",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/18_escaped_newlines_in_an_empty_document_or", "note": "\\<newline> in empty document", "status": "passed"},
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/19_escaped_newlines_at_the_start_of_a_parag", "note": "\\<newline> at paragraph start", "status": "passed"}
          ]
        },
        {
          "feature": "env-boundary-spaces",
          "description": "Spaces before and after horizontal environments",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs, empty env handler",
          "coding_note": "Horizontal environments have ZWSP at end boundary. Trailing whitespace trimmed before ZWSP insertion.",
          "coding_status": "passed",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "whitespace/20_escaped_newlines_after_an_environment", "note": "\\begin{empty}...\\end{empty} boundary spaces", "status": "passed"}
          ]
        }
      ]
    },
    {
      "feature": "macros",
      "sub_features": [
        {
          "feature": "custom-macros-no-args",
          "description": "Custom macros without arguments: \\def\\foo{bar}",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "expand_macro",
          "coding_note": "Simple macro expansion without arguments",
          "coding_status": "extended",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "macros/01_custom_macros_without_arguments", "note": "\\def\\foo{bar}", "status": "extended"}
          ]
        },
        {
          "feature": "custom-macros-mandatory-args",
          "description": "Custom macros with mandatory arguments: \\def\\foo#1{...}",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "expand_macro",
          "coding_note": "Macro expansion with #1, #2 etc. parameters",
          "coding_status": "extended",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "macros/02_custom_macros_with_a_mandatory_argument", "note": "\\def\\foo#1{\\textbf{#1}}", "status": "extended"}
          ]
        },
        {
          "feature": "custom-macros-optional-args",
          "description": "Custom macros with optional arguments: \\newcommand\\foo[1][default]{...}",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "expand_macro",
          "coding_note": "Optional argument handling with default values",
          "coding_status": "extended",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "macros/03_custom_macros_with_an_optional_argument", "note": "\\newcommand with optional args", "status": "extended"}
          ]
        }
      ]
    },
    {
      "feature": "groups",
      "sub_features": [
        {
          "feature": "balanced-groups",
          "description": "Curly brace groups must be balanced",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_doc_element",
          "coding_note": "Groups scope font changes and other settings",
          "coding_status": "extended",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "groups/01_groups_need_to_be_balanced", "note": "Balanced groups scoping", "status": "extended"}
          ]
        },
        {
          "feature": "groups-across-paragraphs",
          "description": "Groups can span paragraphs",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs",
          "coding_note": "Font changes in group persist across paragraph breaks",
          "coding_status": "extended",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "groups/03_groups_overlapping_paragraphs", "note": "Groups spanning paragraphs", "status": "extended"}
          ]
        }
      ]
    },
    {
      "feature": "fonts",
      "sub_features": [
        {
          "feature": "font-declarations",
          "description": "Font declarations: \\bfseries, \\itshape, \\ttfamily, etc.",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_text_command",
          "coding_note": "Font declarations affect subsequent text in scope",
          "coding_status": "extended",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "fonts/*", "note": "Font declaration tests", "status": "extended"}
          ]
        }
      ]
    },
    {
      "feature": "spacing",
      "sub_features": [
        {
          "feature": "horizontal-spacing",
          "description": "Horizontal spacing: \\quad, \\qquad, \\hspace, \\hfill, etc.",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_inline_content",
          "coding_note": "Maps spacing commands to appropriate HTML/CSS",
          "coding_status": "extended",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "spacing/01_different_horizontal_spaces", "note": "\\quad, \\qquad, \\hspace", "status": "extended"}
          ]
        },
        {
          "feature": "vertical-spacing",
          "description": "Vertical spacing: \\smallskip, \\medskip, \\bigskip, \\vspace",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_body_content_with_paragraphs",
          "coding_note": "Vertical spacing between paragraphs",
          "coding_status": "extended",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "spacing/03_smallskip_etc_and_smallbreak_etc_paragra", "note": "\\smallskip, \\medskip, \\bigskip", "status": "extended"}
          ]
        }
      ]
    },
    {
      "feature": "boxes",
      "sub_features": [
        {
          "feature": "box-commands",
          "description": "Box commands: \\mbox, \\fbox, \\makebox, \\framebox, \\llap, \\rlap",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_text_command",
          "coding_note": "Box commands create inline containers with specific behavior",
          "coding_status": "extended",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "boxes/*", "note": "Box command tests", "status": "extended"}
          ]
        }
      ]
    },
    {
      "feature": "references",
      "sub_features": [
        {
          "feature": "label-ref",
          "description": "Cross-references: \\label, \\ref, \\pageref",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "process_label_command, build_ref_command",
          "coding_note": "Labels register targets, refs create hyperlinks",
          "coding_status": "extended",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "label-ref/*", "note": "Label and reference tests", "status": "extended"}
          ]
        },
        {
          "feature": "footnotes",
          "description": "Footnotes: \\footnote{...}",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_footnote_command",
          "coding_note": "Creates footnote markers and footnote content",
          "coding_status": "todo",
          "tests": []
        },
        {
          "feature": "citations",
          "description": "Citations: \\cite{...}",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_cite_command",
          "coding_note": "Creates citation references",
          "coding_status": "todo",
          "tests": []
        }
      ]
    },
    {
      "feature": "links",
      "sub_features": [
        {
          "feature": "hyperlinks",
          "description": "Hyperlinks: \\href{url}{text}, \\url{...}",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_href_command, build_url_command",
          "coding_note": "Creates anchor elements for external links",
          "coding_status": "todo",
          "tests": []
        }
      ]
    },
    {
      "feature": "math",
      "sub_features": [
        {
          "feature": "inline-math",
          "description": "Inline math: $...$, \\(...\\)",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_inline_content",
          "coding_note": "Inline math rendering (requires math engine integration)",
          "coding_status": "todo",
          "tests": []
        },
        {
          "feature": "display-math",
          "description": "Display math: $$...$$, \\[...\\], equation environment",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "build_doc_element",
          "coding_note": "Block-level math rendering",
          "coding_status": "todo",
          "tests": []
        }
      ]
    },
    {
      "feature": "counters",
      "sub_features": [
        {
          "feature": "counter-commands",
          "description": "Counter manipulation: \\newcounter, \\setcounter, \\stepcounter, \\value",
          "code_file": "lambda/tex/tex_document_model.cpp",
          "code_function": "counter_*",
          "coding_note": "LaTeX counter system for numbering",
          "coding_status": "extended",
          "tests": [
            {"file": "test/test_latexml_compare_gtest.cpp", "case": "counters/*", "note": "Counter manipulation tests", "status": "extended"}
          ]
        }
      ]
    }
  ],
  "summary": {
    "total_baseline_tests": 105,
    "latexjs_baseline_tests": 54,
    "hybrid_baseline_tests": 51,
    "total_extended_tests": 64,
    "baseline_passed": 105,
    "extended_passed": 0,
    "extended_failed": 64,
    "extended_skipped": 0
  },
  "last_updated": "2026-01-18",
  "session_notes": "Migrated test infrastructure from test_latex_unified_pipeline.cpp to test_latexml_compare_gtest.cpp. Added Hybrid mode tests (51 baseline) alongside LatexJs legacy mode tests (54 baseline). Total 105 baseline tests passing. Added new features for macros, groups, fonts, spacing, boxes, counters based on latexml fixtures.",

  "output_modes": {
    "legacy": {
      "description": "latex.js compatible output with CSS class-based styling",
      "options": "HtmlOutputOptions::legacy()",
      "class_prefix": "",
      "document_wrapper": "<article class=\"latex-article\">",
      "formatting": "CSS classes (e.g., class=\"bf\", class=\"it\")"
    },
    "hybrid": {
      "description": "Semantic HTML5 output without class prefixes",
      "options": "HtmlOutputOptions::hybrid()",
      "class_prefix": "",
      "document_wrapper": "<article class=\"latex-document\">",
      "formatting": "HTML5 semantic elements (<strong>, <em>, <code>, <u>, <s>)"
    },
    "defaults": {
      "description": "Modern output with latex- class prefix",
      "options": "HtmlOutputOptions::defaults()",
      "class_prefix": "latex-",
      "document_wrapper": "<article class=\"latex-document\">",
      "formatting": "CSS classes with prefix (e.g., class=\"latex-bf\")"
    }
  },

  "blockers_and_dependencies": {
    "alignment-commands": {
      "blockers": [],
      "depends_on": ["basic-text"],
      "blocks": [],
      "resolved": "Implemented alignment markers and current_alignment state tracking."
    },
    "quote-environments": {
      "blockers": [],
      "depends_on": ["basic-text"],
      "blocks": [],
      "resolved": "Hybrid mode uses <blockquote>, legacy uses div with quote class."
    },
    "curly-group-spaces": {
      "blockers": [],
      "depends_on": [],
      "blocks": [],
      "resolved": "ZWSP insertion at group boundaries implemented."
    },
    "nested-sectioning": {
      "blockers": [],
      "depends_on": ["chapter-section"],
      "blocks": [],
      "resolved": "Passing in baseline tests."
    }
  },

  "code_hotspots": {
    "build_body_content_with_paragraphs": {
      "file": "lambda/tex/tex_document_model.cpp",
      "line_range": "4450-4920",
      "responsibility": "Main paragraph/content builder, handles parbreaks, block elements, text accumulation",
      "complexity": "high"
    },
    "build_list_environment": {
      "file": "lambda/tex/tex_document_model.cpp",
      "line_range": "3363-3520",
      "responsibility": "Build itemize/enumerate/description lists with items",
      "complexity": "high"
    },
    "render_list_html": {
      "file": "lambda/tex/tex_document_model.cpp",
      "line_range": "1150-1250",
      "responsibility": "Render lists with mode-specific class names",
      "complexity": "medium"
    },
    "render_paragraph_html": {
      "file": "lambda/tex/tex_document_model.cpp",
      "line_range": "1020-1070",
      "responsibility": "Render paragraph with class flags",
      "complexity": "low"
    }
  },

  "feature_priorities": {
    "high": [
      {"feature": "table-environment", "complexity": "high", "note": "Tables not yet implemented"},
      {"feature": "figure-environment", "complexity": "medium", "note": "Figures with captions not yet implemented"}
    ],
    "medium": [
      {"feature": "custom-macros", "complexity": "high", "note": "Macro expansion in extended tests"},
      {"feature": "horizontal-spacing", "complexity": "medium", "note": "Spacing commands in extended tests"}
    ],
    "low": [
      {"feature": "counter-commands", "complexity": "medium", "note": "Counter manipulation"},
      {"feature": "label-ref", "complexity": "medium", "note": "Cross-references"}
    ]
  }
}
